---
description:
globs: **/*.ts,**/*.tsx
alwaysApply: false
---

# Code Conventions

## TypeScript

- Follow idiomatic TypeScript for structure, naming, and type usage unless a file dictates otherwise.
- Prefer interfaces for object shapes and `type` aliases for unions or mapped types.
- Avoid `any` and unsafe type assertions; reach for `unknown`, narrowings, and Zod schemas where runtime validation is required.
- Keep related type definitions close to their usage. When a type needs to be shared, export it from a nearby `index.ts` or dedicated `types.ts` file.
- Use `Selectable`, `Insertable`, and `Updateable` from `kysely` when working with database records (see `packages/db`).
- Run `pnpm typecheck` after meaningful changes to ensure the project stays buildable.

## React Components

- Use kebab-case for file and directory names.
- Use named exports for components and import React hooks directly (e.g., `import { useState } from 'react'`).
- Build components with clear separation of concerns, and keep stateful logic near the UI that consumes it.
- Use `cn` from `@/lib/utils` for class name composition and rely on shadcn UI primitives from `apps/web/src/components/ui` when possible.
- Favour `zod` and `react-hook-form` for validated forms; both libraries are already available in the project.

## API Access Patterns

- In React components, obtain the tRPC client with `useTRPCClient` from `@/client/trpc` and call procedures with `.query` / `.mutate` / `.subscribe` as needed.
- Shared business logic lives in `packages/api` (helpers and routers). Export anything that needs to be consumed in `apps/web` from `packages/api/src/index.ts`.
- Keep the frontend (`apps/web`) focused on presentation and lightweight data orchestration. Defer heavy data fetching logic to tRPC procedures.

## Package Installation

- This monorepo uses pnpm workspaces. When installing dependencies, target the package that needs them (e.g. `pnpm add uuid --filter @app/web`).
- Install runtime packages with `--filter` and add corresponding type packages as dev dependencies of the same workspace if required.
